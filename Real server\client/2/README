Вроде бы, логика правильная.
Сначала мы создаем потоки, которые отвечают за связь с клиентом.
Потом, если приходит запрос на соединение, меняем один свободный accept.
Если связь закончилась, accept становится равным -5, потом мы можем его использовать.
С клиента нельзя выключить сервер!